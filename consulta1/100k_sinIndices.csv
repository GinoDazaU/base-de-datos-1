"QUERY PLAN"
"Sort  (cost=181844.14..182264.75 rows=168244 width=174) (actual time=8490.265..8513.762 rows=3584 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (EXTRACT(year FROM ped.fecha))"
"  Sort Method: quicksort  Memory: 651kB"
"  ->  Finalize GroupAggregate  (cost=77394.53..152862.40 rows=168244 width=174) (actual time=2305.073..8502.970 rows=3584 loops=1)"
"        Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"        Filter: (sum(dp.cantidad_solicitada) > 10)"
"        Rows Removed by Filter: 715066"
"        ->  Gather Merge  (cost=77394.53..134355.56 rows=420610 width=174) (actual time=2302.276..6822.215 rows=718650 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Partial GroupAggregate  (cost=76394.50..84806.70 rows=210305 width=174) (actual time=2208.302..4596.994 rows=239550 loops=3)"
"                    Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                    ->  Sort  (cost=76394.50..76920.27 rows=210305 width=144) (actual time=2208.278..4008.563 rows=241633 loops=3)"
"                          Sort Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                          Sort Method: external merge  Disk: 21272kB"
"                          Worker 0:  Sort Method: external merge  Disk: 36456kB"
"                          Worker 1:  Sort Method: external merge  Disk: 36320kB"
"                          ->  Hash Left Join  (cost=24294.66..42705.81 rows=210305 width=144) (actual time=178.663..712.284 rows=241633 loops=3)"
"                                Hash Cond: (ped.id_pedido = pa.id_pedido)"
"                                ->  Parallel Hash Semi Join  (cost=21175.66..35906.47 rows=210305 width=115) (actual time=145.124..563.901 rows=176488 loops=3)"
"                                      Hash Cond: (ped.id_pedido = dp_sub.id_pedido)"
"                                      ->  Hash Join  (cost=15657.82..27129.54 rows=250119 width=123) (actual time=121.775..462.479 rows=200115 loops=3)"
"                                            Hash Cond: (h.id_cliente = cli.id_cliente)"
"                                            ->  Hash Join  (cost=15569.28..23914.51 rows=125060 width=72) (actual time=119.337..406.289 rows=100058 loops=3)"
"                                                  Hash Cond: (ped.id_pedido = h.id_pedido)"
"                                                  ->  Hash Join  (cost=12876.28..20893.22 rows=125060 width=64) (actual time=97.178..328.232 rows=100058 loops=3)"
"                                                        Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                        ->  Parallel Hash Join  (cost=9171.41..16860.01 rows=125072 width=56) (actual time=59.589..236.265 rows=100058 loops=3)"
"                                                              Hash Cond: (p.id_producto = dp.id_producto)"
"                                                              ->  Parallel Hash Join  (cost=2990.54..9474.67 rows=125000 width=46) (actual time=15.793..112.354 rows=100000 loops=3)"
"                                                                    Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                                                    ->  Parallel Seq Scan on productos p  (cost=0.00..6156.00 rows=125000 width=30) (actual time=0.357..31.278 rows=100000 loops=3)"
"                                                                    ->  Parallel Hash  (cost=2255.24..2255.24 rows=58824 width=24) (actual time=14.813..14.816 rows=33333 loops=3)"
"                                                                          Buckets: 131072  Batches: 1  Memory Usage: 6912kB"
"                                                                          ->  Parallel Seq Scan on proveedores prov  (cost=0.00..2255.24 rows=58824 width=24) (actual time=0.018..5.443 rows=33333 loops=3)"
"                                                              ->  Parallel Hash  (cost=3973.72..3973.72 rows=176572 width=18) (actual time=43.180..43.181 rows=100058 loops=3)"
"                                                                    Buckets: 524288  Batches: 1  Memory Usage: 20576kB"
"                                                                    ->  Parallel Seq Scan on detallespedido dp  (cost=0.00..3973.72 rows=176572 width=18) (actual time=0.010..14.393 rows=100058 loops=3)"
"                                                        ->  Hash  (cost=2455.00..2455.00 rows=99990 width=8) (actual time=37.194..37.195 rows=100000 loops=3)"
"                                                              Buckets: 131072  Batches: 1  Memory Usage: 4931kB"
"                                                              ->  Seq Scan on pedidos ped  (cost=0.00..2455.00 rows=99990 width=8) (actual time=0.570..22.061 rows=100000 loops=3)"
"                                                                    Filter: (fecha >= (CURRENT_DATE - '3 years'::interval))"
"                                                  ->  Hash  (cost=1443.00..1443.00 rows=100000 width=8) (actual time=21.823..21.824 rows=100000 loops=3)"
"                                                        Buckets: 131072  Batches: 1  Memory Usage: 4931kB"
"                                                        ->  Seq Scan on hace h  (cost=0.00..1443.00 rows=100000 width=8) (actual time=0.352..8.154 rows=100000 loops=3)"
"                                            ->  Hash  (cost=76.03..76.03 rows=1000 width=63) (actual time=2.424..2.430 rows=1000 loops=3)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                                  ->  Hash Join  (cost=46.75..76.03 rows=1000 width=63) (actual time=1.699..2.199 rows=1000 loops=3)"
"                                                        Hash Cond: (a.id_cliente = cli.id_cliente)"
"                                                        ->  Hash Join  (cost=27.50..54.14 rows=1000 width=21) (actual time=0.947..1.256 rows=1000 loops=3)"
"                                                              Hash Cond: (kio.id_kiosko = a.id_kiosko)"
"                                                              ->  Seq Scan on kiosko kio  (cost=0.00..24.00 rows=1000 width=21) (actual time=0.389..0.493 rows=1000 loops=3)"
"                                                              ->  Hash  (cost=15.00..15.00 rows=1000 width=8) (actual time=0.542..0.543 rows=1000 loops=3)"
"                                                                    Buckets: 1024  Batches: 1  Memory Usage: 48kB"
"                                                                    ->  Seq Scan on administra a  (cost=0.00..15.00 rows=1000 width=8) (actual time=0.324..0.411 rows=1000 loops=3)"
"                                                        ->  Hash  (cost=13.00..13.00 rows=500 width=42) (actual time=0.737..0.738 rows=500 loops=3)"
"                                                              Buckets: 1024  Batches: 1  Memory Usage: 46kB"
"                                                              ->  Seq Scan on clientes cli  (cost=0.00..13.00 rows=500 width=42) (actual time=0.556..0.638 rows=500 loops=3)"
"                                      ->  Parallel Hash  (cost=4415.15..4415.15 rows=88215 width=4) (actual time=22.726..22.727 rows=50035 loops=3)"
"                                            Buckets: 262144  Batches: 1  Memory Usage: 7936kB"
"                                            ->  Parallel Seq Scan on detallespedido dp_sub  (cost=0.00..4415.15 rows=88215 width=4) (actual time=0.011..35.175 rows=150104 loops=1)"
"                                                  Filter: (cantidad_solicitada > 5)"
"                                                  Rows Removed by Filter: 150069"
"                                ->  Hash  (cost=1869.00..1869.00 rows=100000 width=9) (actual time=33.013..33.014 rows=100000 loops=3)"
"                                      Buckets: 131072  Batches: 1  Memory Usage: 5321kB"
"                                      ->  Seq Scan on pagos pa  (cost=0.00..1869.00 rows=100000 width=9) (actual time=0.707..14.266 rows=100000 loops=3)"
"Planning Time: 12.315 ms"
"Execution Time: 8521.093 ms"
