"QUERY PLAN"
"Sort  (cost=2345643.43..2349830.99 rows=1675023 width=175) (actual time=98114.576..98529.348 rows=34176 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (EXTRACT(year FROM ped.fecha))"
"  Sort Method: external merge  Disk: 4624kB"
"  ->  Finalize GroupAggregate  (cost=1134864.84..1886216.65 rows=1675023 width=175) (actual time=24135.163..37412.780 rows=34176 loops=1)"
"        Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"        Filter: (sum(dp.cantidad_solicitada) > 10)"
"        Rows Removed by Filter: 7135030"
"        ->  Gather Merge  (cost=1134864.84..1701964.09 rows=4187558 width=175) (actual time=24134.815..32830.119 rows=7169408 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Partial GroupAggregate  (cost=1133864.81..1217615.97 rows=2093779 width=175) (actual time=24105.363..28986.422 rows=2389803 loops=3)"
"                    Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                    ->  Sort  (cost=1133864.81..1139099.26 rows=2093779 width=145) (actual time=24105.330..27207.702 rows=2409923 loops=3)"
"                          Sort Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                          Sort Method: external merge  Disk: 313728kB"
"                          Worker 0:  Sort Method: external merge  Disk: 313528kB"
"                          Worker 1:  Sort Method: external merge  Disk: 312096kB"
"                          ->  Parallel Hash Left Join  (cost=196495.22..599154.33 rows=2093779 width=145) (actual time=6142.678..6873.569 rows=2409923 loops=3)"
"                                Hash Cond: (ped.id_pedido = pa.id_pedido)"
"                                ->  Parallel Hash Semi Join  (cost=176400.22..481604.12 rows=2093779 width=116) (actual time=4708.886..5206.682 rows=1761858 loops=3)"
"                                      Hash Cond: (ped.id_pedido = dp_sub.id_pedido)"
"                                      ->  Hash Join  (cost=128449.06..308613.78 rows=2499008 width=124) (actual time=963.708..3947.756 rows=1999207 loops=3)"
"                                            Hash Cond: (h.id_cliente = cli.id_cliente)"
"                                            ->  Nested Loop  (cost=128360.53..277287.64 rows=1249504 width=73) (actual time=962.885..3665.866 rows=999603 loops=3)"
"                                                  ->  Parallel Hash Join  (cost=128360.53..220828.43 rows=1249504 width=57) (actual time=962.814..1470.952 rows=999603 loops=3)"
"                                                        Hash Cond: (dp.id_producto = p.id_producto)"
"                                                        ->  Parallel Hash Join  (cost=42983.76..104100.71 rows=1249504 width=34) (actual time=411.955..592.115 rows=999603 loops=3)"
"                                                              Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                              ->  Parallel Seq Scan on detallespedido dp  (cost=0.00..34546.04 rows=1249504 width=18) (actual time=0.041..69.683 rows=999603 loops=3)"
"                                                              ->  Parallel Hash  (cost=35740.42..35740.42 rows=416667 width=16) (actual time=231.542..231.545 rows=333333 loops=3)"
"                                                                    Buckets: 262144  Batches: 8  Memory Usage: 7936kB"
"                                                                    ->  Parallel Hash Join  (cost=15428.00..35740.42 rows=416667 width=16) (actual time=124.652..185.222 rows=333333 loops=3)"
"                                                                          Hash Cond: (ped.id_pedido = h.id_pedido)"
"                                                                          ->  Parallel Seq Scan on pedidos ped  (cost=0.00..14334.67 rows=416667 width=8) (actual time=0.046..35.501 rows=333333 loops=3)"
"                                                                                Filter: (fecha >= (CURRENT_DATE - '3 years'::interval))"
"                                                                          ->  Parallel Hash  (cost=8591.67..8591.67 rows=416667 width=8) (actual time=51.673..51.673 rows=333333 loops=3)"
"                                                                                Buckets: 262144  Batches: 8  Memory Usage: 6976kB"
"                                                                                ->  Parallel Seq Scan on hace h  (cost=0.00..8591.67 rows=416667 width=8) (actual time=0.022..17.119 rows=333333 loops=3)"
"                                                        ->  Parallel Hash  (cost=61201.01..61201.01 rows=1250301 width=31) (actual time=222.645..222.646 rows=1000000 loops=3)"
"                                                              Buckets: 131072  Batches: 32  Memory Usage: 7200kB"
"                                                              ->  Parallel Seq Scan on productos p  (cost=0.00..61201.01 rows=1250301 width=31) (actual time=0.017..84.918 rows=1000000 loops=3)"
"                                                  ->  Index Scan using idx_proveedores_id_proveedor_hash on proveedores prov  (cost=0.00..0.05 rows=1 width=24) (actual time=0.002..0.002 rows=1 loops=2998810)"
"                                                        Index Cond: (id_proveedor = p.id_proveedor)"
"                                                        Rows Removed by Index Recheck: 0"
"                                            ->  Hash  (cost=76.03..76.03 rows=1000 width=63) (actual time=0.803..0.806 rows=1000 loops=3)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                                  ->  Hash Join  (cost=46.75..76.03 rows=1000 width=63) (actual time=0.344..0.688 rows=1000 loops=3)"
"                                                        Hash Cond: (a.id_cliente = cli.id_cliente)"
"                                                        ->  Hash Join  (cost=27.50..54.14 rows=1000 width=21) (actual time=0.171..0.406 rows=1000 loops=3)"
"                                                              Hash Cond: (kio.id_kiosko = a.id_kiosko)"
"                                                              ->  Seq Scan on kiosko kio  (cost=0.00..24.00 rows=1000 width=21) (actual time=0.013..0.131 rows=1000 loops=3)"
"                                                              ->  Hash  (cost=15.00..15.00 rows=1000 width=8) (actual time=0.145..0.145 rows=1000 loops=3)"
"                                                                    Buckets: 1024  Batches: 1  Memory Usage: 48kB"
"                                                                    ->  Seq Scan on administra a  (cost=0.00..15.00 rows=1000 width=8) (actual time=0.007..0.069 rows=1000 loops=3)"
"                                                        ->  Hash  (cost=13.00..13.00 rows=500 width=42) (actual time=0.161..0.161 rows=500 loops=3)"
"                                                              Buckets: 1024  Batches: 1  Memory Usage: 46kB"
"                                                              ->  Seq Scan on clientes cli  (cost=0.00..13.00 rows=500 width=42) (actual time=0.037..0.100 rows=500 loops=3)"
"                                      ->  Parallel Hash  (cost=37669.80..37669.80 rows=626668 width=4) (actual time=118.451..118.452 rows=499991 loops=3)"
"                                            Buckets: 262144  Batches: 16  Memory Usage: 5760kB"
"                                            ->  Parallel Seq Scan on detallespedido dp_sub  (cost=0.00..37669.80 rows=626668 width=4) (actual time=0.039..65.486 rows=499991 loops=3)"
"                                                  Filter: (cantidad_solicitada > 5)"
"                                                  Rows Removed by Filter: 499613"
"                                ->  Parallel Hash  (cost=12851.67..12851.67 rows=416667 width=9) (actual time=456.504..456.505 rows=333333 loops=3)"
"                                      Buckets: 262144  Batches: 8  Memory Usage: 7968kB"
"                                      ->  Parallel Seq Scan on pagos pa  (cost=0.00..12851.67 rows=416667 width=9) (actual time=394.644..418.140 rows=333333 loops=3)"
"Planning Time: 5.579 ms"
"JIT:"
"  Functions: 238"
"  Options: Inlining true, Optimization true, Expressions true, Deforming true"
"  Timing: Generation 6.776 ms, Inlining 167.674 ms, Optimization 567.774 ms, Emission 449.177 ms, Total 1191.400 ms"
"Execution Time: 98586.292 ms"
