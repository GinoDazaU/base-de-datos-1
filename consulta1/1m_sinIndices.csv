"QUERY PLAN"
"Sort  (cost=2256406.85..2260385.60 rows=1591500 width=175) (actual time=149165.529..150075.829 rows=34176 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (EXTRACT(year FROM ped.fecha))"
"  Sort Method: external merge  Disk: 4632kB"
"  ->  Finalize GroupAggregate  (cost=1106595.30..1820481.79 rows=1591500 width=175) (actual time=84510.633..149913.101 rows=34176 loops=1)"
"        Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"        Filter: (sum(dp.cantidad_solicitada) > 10)"
"        Rows Removed by Filter: 7135030"
"        ->  Gather Merge  (cost=1106595.30..1645416.77 rows=3978750 width=175) (actual time=84509.116..133484.848 rows=7169430 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Partial GroupAggregate  (cost=1105595.28..1185170.28 rows=1989375 width=175) (actual time=84227.354..107919.644 rows=2389810 loops=3)"
"                    Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                    ->  Sort  (cost=1105595.28..1110568.72 rows=1989375 width=145) (actual time=84227.325..101671.060 rows=2409923 loops=3)"
"                          Sort Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                          Sort Method: external merge  Disk: 314880kB"
"                          Worker 0:  Sort Method: external merge  Disk: 313592kB"
"                          Worker 1:  Sort Method: external merge  Disk: 311840kB"
"                          ->  Parallel Hash Left Join  (cost=225436.05..598281.02 rows=1989375 width=145) (actual time=20374.969..24204.121 rows=2409923 loops=3)"
"                                Hash Cond: (ped.id_pedido = pa.id_pedido)"
"                                ->  Parallel Hash Semi Join  (cost=205341.04..485488.35 rows=1989375 width=116) (actual time=15334.558..18294.683 rows=1761858 loops=3)"
"                                      Hash Cond: (ped.id_pedido = dp_sub.id_pedido)"
"                                      ->  Hash Join  (cost=157324.96..313589.21 rows=2498763 width=124) (actual time=10080.037..12630.300 rows=1999207 loops=3)"
"                                            Hash Cond: (h.id_cliente = cli.id_cliente)"
"                                            ->  Parallel Hash Join  (cost=157236.42..282266.13 rows=1249382 width=73) (actual time=10074.432..11648.573 rows=999603 loops=3)"
"                                                  Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                                  ->  Parallel Hash Join  (cost=128748.42..221212.49 rows=1249382 width=57) (actual time=7494.605..8983.516 rows=999603 loops=3)"
"                                                        Hash Cond: (dp.id_producto = p.id_producto)"
"                                                        ->  Parallel Hash Join  (cost=42983.73..104100.18 rows=1249382 width=34) (actual time=3822.768..4745.056 rows=999603 loops=3)"
"                                                              Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                              ->  Parallel Seq Scan on detallespedido dp  (cost=0.00..34546.04 rows=1249504 width=18) (actual time=0.581..1222.967 rows=999603 loops=3)"
"                                                              ->  Parallel Hash  (cost=35740.91..35740.91 rows=416626 width=16) (actual time=1943.087..1943.104 rows=333333 loops=3)"
"                                                                    Buckets: 262144  Batches: 8  Memory Usage: 7936kB"
"                                                                    ->  Parallel Hash Join  (cost=21171.49..35740.91 rows=416626 width=16) (actual time=1472.726..1810.986 rows=333333 loops=3)"
"                                                                          Hash Cond: (h.id_pedido = ped.id_pedido)"
"                                                                          ->  Parallel Seq Scan on hace h  (cost=0.00..8591.67 rows=416667 width=8) (actual time=1.046..539.744 rows=333333 loops=3)"
"                                                                          ->  Parallel Hash  (cost=14335.67..14335.67 rows=416626 width=8) (actual time=723.950..723.955 rows=333333 loops=3)"
"                                                                                Buckets: 262144  Batches: 8  Memory Usage: 7008kB"
"                                                                                ->  Parallel Seq Scan on pedidos ped  (cost=0.00..14335.67 rows=416626 width=8) (actual time=2.299..556.465 rows=333333 loops=3)"
"                                                                                      Filter: (fecha >= (CURRENT_DATE - '3 years'::interval))"
"                                                        ->  Parallel Hash  (cost=61592.75..61592.75 rows=1250075 width=31) (actual time=2021.851..2021.852 rows=1000000 loops=3)"
"                                                              Buckets: 131072  Batches: 32  Memory Usage: 7200kB"
"                                                              ->  Parallel Seq Scan on productos p  (cost=0.00..61592.75 rows=1250075 width=31) (actual time=0.758..1612.184 rows=1000000 loops=3)"
"                                                  ->  Parallel Hash  (cost=20837.67..20837.67 rows=416667 width=24) (actual time=395.402..395.403 rows=333333 loops=3)"
"                                                        Buckets: 131072  Batches: 8  Memory Usage: 8352kB"
"                                                        ->  Parallel Seq Scan on proveedores prov  (cost=0.00..20837.67 rows=416667 width=24) (actual time=0.700..274.259 rows=333333 loops=3)"
"                                            ->  Hash  (cost=76.03..76.03 rows=1000 width=63) (actual time=5.531..5.541 rows=1000 loops=3)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                                  ->  Hash Join  (cost=46.75..76.03 rows=1000 width=63) (actual time=3.974..5.082 rows=1000 loops=3)"
"                                                        Hash Cond: (a.id_cliente = cli.id_cliente)"
"                                                        ->  Hash Join  (cost=27.50..54.14 rows=1000 width=21) (actual time=2.066..2.766 rows=1000 loops=3)"
"                                                              Hash Cond: (kio.id_kiosko = a.id_kiosko)"
"                                                              ->  Seq Scan on kiosko kio  (cost=0.00..24.00 rows=1000 width=21) (actual time=0.779..1.019 rows=1000 loops=3)"
"                                                              ->  Hash  (cost=15.00..15.00 rows=1000 width=8) (actual time=1.080..1.081 rows=1000 loops=3)"
"                                                                    Buckets: 1024  Batches: 1  Memory Usage: 48kB"
"                                                                    ->  Seq Scan on administra a  (cost=0.00..15.00 rows=1000 width=8) (actual time=0.656..0.846 rows=1000 loops=3)"
"                                                        ->  Hash  (cost=13.00..13.00 rows=500 width=42) (actual time=1.869..1.871 rows=500 loops=3)"
"                                                              Buckets: 1024  Batches: 1  Memory Usage: 46kB"
"                                                              ->  Seq Scan on clientes cli  (cost=0.00..13.00 rows=500 width=42) (actual time=1.358..1.549 rows=500 loops=3)"
"                                      ->  Parallel Hash  (cost=37669.80..37669.80 rows=630583 width=4) (actual time=578.700..578.702 rows=499991 loops=3)"
"                                            Buckets: 262144  Batches: 16  Memory Usage: 5760kB"
"                                            ->  Parallel Seq Scan on detallespedido dp_sub  (cost=0.00..37669.80 rows=630583 width=4) (actual time=0.790..364.315 rows=499991 loops=3)"
"                                                  Filter: (cantidad_solicitada > 5)"
"                                                  Rows Removed by Filter: 499613"
"                                ->  Parallel Hash  (cost=12851.67..12851.67 rows=416667 width=9) (actual time=250.038..250.039 rows=333333 loops=3)"
"                                      Buckets: 262144  Batches: 8  Memory Usage: 7968kB"
"                                      ->  Parallel Seq Scan on pagos pa  (cost=0.00..12851.67 rows=416667 width=9) (actual time=0.736..119.330 rows=333333 loops=3)"
"Planning Time: 27.150 ms"
"Execution Time: 150143.176 ms"
