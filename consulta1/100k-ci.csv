"QUERY PLAN"
"Sort  (cost=180257.91..180674.10 rows=166476 width=174) (actual time=2229.941..2243.170 rows=3584 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (EXTRACT(year FROM ped.fecha))"
"  Sort Method: quicksort  Memory: 650kB"
"  ->  Finalize GroupAggregate  (cost=76918.01..151592.82 rows=166476 width=174) (actual time=943.155..2241.278 rows=3584 loops=1)"
"        Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"        Filter: (sum(dp.cantidad_solicitada) > 10)"
"        Rows Removed by Filter: 715066"
"        ->  Gather Merge  (cost=76918.01..133280.46 rows=416190 width=174) (actual time=942.421..1832.961 rows=718650 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Partial GroupAggregate  (cost=75917.98..84241.78 rows=208095 width=174) (actual time=922.444..1385.716 rows=239550 loops=3)"
"                    Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                    ->  Sort  (cost=75917.98..76438.22 rows=208095 width=144) (actual time=922.415..1239.226 rows=241633 loops=3)"
"                          Sort Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"                          Sort Method: external merge  Disk: 30984kB"
"                          Worker 0:  Sort Method: external merge  Disk: 32128kB"
"                          Worker 1:  Sort Method: external merge  Disk: 30840kB"
"                          ->  Hash Left Join  (cost=24292.51..42598.03 rows=208095 width=144) (actual time=132.438..422.220 rows=241633 loops=3)"
"                                Hash Cond: (ped.id_pedido = pa.id_pedido)"
"                                ->  Parallel Hash Semi Join  (cost=21173.51..35837.37 rows=208095 width=115) (actual time=115.722..340.085 rows=176488 loops=3)"
"                                      Hash Cond: (ped.id_pedido = dp_sub.id_pedido)"
"                                      ->  Hash Join  (cost=15657.94..27090.00 rows=250144 width=123) (actual time=75.704..258.128 rows=200115 loops=3)"
"                                            Hash Cond: (h.id_cliente = cli.id_cliente)"
"                                            ->  Hash Join  (cost=15569.41..23874.67 rows=125072 width=72) (actual time=75.012..230.258 rows=100058 loops=3)"
"                                                  Hash Cond: (ped.id_pedido = h.id_pedido)"
"                                                  ->  Hash Join  (cost=12876.41..20853.34 rows=125072 width=64) (actual time=62.449..183.475 rows=100058 loops=3)"
"                                                        Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                        ->  Parallel Hash Join  (cost=9171.41..16820.01 rows=125072 width=56) (actual time=40.192..126.590 rows=100058 loops=3)"
"                                                              Hash Cond: (p.id_producto = dp.id_producto)"
"                                                              ->  Parallel Hash Join  (cost=2990.54..9434.67 rows=125000 width=46) (actual time=12.507..56.525 rows=100000 loops=3)"
"                                                                    Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                                                    ->  Parallel Seq Scan on productos p  (cost=0.00..6116.00 rows=125000 width=30) (actual time=0.016..9.258 rows=100000 loops=3)"
"                                                                    ->  Parallel Hash  (cost=2255.24..2255.24 rows=58824 width=24) (actual time=10.810..10.810 rows=33333 loops=3)"
"                                                                          Buckets: 131072  Batches: 1  Memory Usage: 6912kB"
"                                                                          ->  Parallel Seq Scan on proveedores prov  (cost=0.00..2255.24 rows=58824 width=24) (actual time=0.028..3.005 rows=33333 loops=3)"
"                                                              ->  Parallel Hash  (cost=3973.72..3973.72 rows=176572 width=18) (actual time=26.767..26.767 rows=100058 loops=3)"
"                                                                    Buckets: 524288  Batches: 1  Memory Usage: 20608kB"
"                                                                    ->  Parallel Seq Scan on detallespedido dp  (cost=0.00..3973.72 rows=176572 width=18) (actual time=0.020..7.835 rows=100058 loops=3)"
"                                                        ->  Hash  (cost=2455.00..2455.00 rows=100000 width=8) (actual time=21.859..21.859 rows=100000 loops=3)"
"                                                              Buckets: 131072  Batches: 1  Memory Usage: 4931kB"
"                                                              ->  Seq Scan on pedidos ped  (cost=0.00..2455.00 rows=100000 width=8) (actual time=0.033..11.060 rows=100000 loops=3)"
"                                                                    Filter: (fecha >= (CURRENT_DATE - '3 years'::interval))"
"                                                  ->  Hash  (cost=1443.00..1443.00 rows=100000 width=8) (actual time=12.242..12.242 rows=100000 loops=3)"
"                                                        Buckets: 131072  Batches: 1  Memory Usage: 4931kB"
"                                                        ->  Seq Scan on hace h  (cost=0.00..1443.00 rows=100000 width=8) (actual time=0.007..4.346 rows=100000 loops=3)"
"                                            ->  Hash  (cost=76.03..76.03 rows=1000 width=63) (actual time=0.673..0.675 rows=1000 loops=3)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                                  ->  Hash Join  (cost=46.75..76.03 rows=1000 width=63) (actual time=0.270..0.564 rows=1000 loops=3)"
"                                                        Hash Cond: (a.id_cliente = cli.id_cliente)"
"                                                        ->  Hash Join  (cost=27.50..54.14 rows=1000 width=21) (actual time=0.138..0.321 rows=1000 loops=3)"
"                                                              Hash Cond: (kio.id_kiosko = a.id_kiosko)"
"                                                              ->  Seq Scan on kiosko kio  (cost=0.00..24.00 rows=1000 width=21) (actual time=0.005..0.058 rows=1000 loops=3)"
"                                                              ->  Hash  (cost=15.00..15.00 rows=1000 width=8) (actual time=0.122..0.122 rows=1000 loops=3)"
"                                                                    Buckets: 1024  Batches: 1  Memory Usage: 48kB"
"                                                                    ->  Seq Scan on administra a  (cost=0.00..15.00 rows=1000 width=8) (actual time=0.005..0.049 rows=1000 loops=3)"
"                                                        ->  Hash  (cost=13.00..13.00 rows=500 width=42) (actual time=0.123..0.124 rows=500 loops=3)"
"                                                              Buckets: 1024  Batches: 1  Memory Usage: 46kB"
"                                                              ->  Seq Scan on clientes cli  (cost=0.00..13.00 rows=500 width=42) (actual time=0.030..0.069 rows=500 loops=3)"
"                                      ->  Parallel Hash  (cost=4415.15..4415.15 rows=88033 width=4) (actual time=39.483..39.483 rows=50035 loops=3)"
"                                            Buckets: 262144  Batches: 1  Memory Usage: 8000kB"
"                                            ->  Parallel Seq Scan on detallespedido dp_sub  (cost=0.00..4415.15 rows=88033 width=4) (actual time=25.787..32.293 rows=50035 loops=3)"
"                                                  Filter: (cantidad_solicitada > 5)"
"                                                  Rows Removed by Filter: 50023"
"                                ->  Hash  (cost=1869.00..1869.00 rows=100000 width=9) (actual time=16.320..16.321 rows=100000 loops=3)"
"                                      Buckets: 131072  Batches: 1  Memory Usage: 5321kB"
"                                      ->  Seq Scan on pagos pa  (cost=0.00..1869.00 rows=100000 width=9) (actual time=0.015..6.252 rows=100000 loops=3)"
"Planning Time: 3.019 ms"
"JIT:"
"  Functions: 250"
"  Options: Inlining false, Optimization false, Expressions true, Deforming true"
"  Timing: Generation 5.728 ms, Inlining 0.000 ms, Optimization 2.844 ms, Emission 74.913 ms, Total 83.484 ms"
"Execution Time: 2259.640 ms"
