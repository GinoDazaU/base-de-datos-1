"QUERY PLAN"
"[
  {
    ""Plan"": {
      ""Node Type"": ""Sort"",
      ""Parallel Aware"": false,
      ""Async Capable"": false,
      ""Actual Rows"": 24,
      ""Actual Loops"": 1,
      ""Sort Key"": [""(sum(dp.subtotal)) DESC"", ""(EXTRACT(year FROM ped.fecha))""],
      ""Sort Method"": ""quicksort"",
      ""Sort Space Used"": 28,
      ""Sort Space Type"": ""Memory"",
      ""Plans"": [
        {
          ""Node Type"": ""Aggregate"",
          ""Strategy"": ""Hashed"",
          ""Partial Mode"": ""Simple"",
          ""Parent Relationship"": ""Outer"",
          ""Parallel Aware"": false,
          ""Async Capable"": false,
          ""Actual Rows"": 24,
          ""Actual Loops"": 1,
          ""Group Key"": [""cli.nombre"", ""cli.correo"", ""kio.nombre"", ""prov.nombre"", ""p.nombre"", ""pa.monto"", ""EXTRACT(year FROM ped.fecha)""],
          ""Filter"": ""(sum(dp.cantidad_solicitada) > 10)"",
          ""HashAgg Batches"": 1,
          ""Peak Memory Usage"": 4241,
          ""Disk Usage"": 0,
          ""Rows Removed by Filter"": 7094,
          ""Plans"": [
            {
              ""Node Type"": ""Hash Join"",
              ""Parent Relationship"": ""Outer"",
              ""Parallel Aware"": false,
              ""Async Capable"": false,
              ""Join Type"": ""Inner"",
              ""Actual Rows"": 7166,
              ""Actual Loops"": 1,
              ""Inner Unique"": true,
              ""Hash Cond"": ""(ped.id_pedido = dp_sub.id_pedido)"",
              ""Plans"": [
                {
                  ""Node Type"": ""Nested Loop"",
                  ""Parent Relationship"": ""Outer"",
                  ""Parallel Aware"": false,
                  ""Async Capable"": false,
                  ""Join Type"": ""Left"",
                  ""Actual Rows"": 8084,
                  ""Actual Loops"": 1,
                  ""Inner Unique"": false,
                  ""Plans"": [
                    {
                      ""Node Type"": ""Hash Join"",
                      ""Parent Relationship"": ""Outer"",
                      ""Parallel Aware"": false,
                      ""Async Capable"": false,
                      ""Join Type"": ""Inner"",
                      ""Actual Rows"": 5930,
                      ""Actual Loops"": 1,
                      ""Inner Unique"": false,
                      ""Hash Cond"": ""(h.id_cliente = a.id_cliente)"",
                      ""Plans"": [
                        {
                          ""Node Type"": ""Hash Join"",
                          ""Parent Relationship"": ""Outer"",
                          ""Parallel Aware"": false,
                          ""Async Capable"": false,
                          ""Join Type"": ""Inner"",
                          ""Actual Rows"": 2965,
                          ""Actual Loops"": 1,
                          ""Inner Unique"": true,
                          ""Hash Cond"": ""(p.id_proveedor = prov.id_proveedor)"",
                          ""Plans"": [
                            {
                              ""Node Type"": ""Hash Join"",
                              ""Parent Relationship"": ""Outer"",
                              ""Parallel Aware"": false,
                              ""Async Capable"": false,
                              ""Join Type"": ""Inner"",
                              ""Actual Rows"": 2965,
                              ""Actual Loops"": 1,
                              ""Inner Unique"": true,
                              ""Hash Cond"": ""(dp.id_producto = p.id_producto)"",
                              ""Plans"": [
                                {
                                  ""Node Type"": ""Nested Loop"",
                                  ""Parent Relationship"": ""Outer"",
                                  ""Parallel Aware"": false,
                                  ""Async Capable"": false,
                                  ""Join Type"": ""Inner"",
                                  ""Actual Rows"": 2965,
                                  ""Actual Loops"": 1,
                                  ""Inner Unique"": false,
                                  ""Plans"": [
                                    {
                                      ""Node Type"": ""Hash Join"",
                                      ""Parent Relationship"": ""Outer"",
                                      ""Parallel Aware"": false,
                                      ""Async Capable"": false,
                                      ""Join Type"": ""Inner"",
                                      ""Actual Rows"": 1000,
                                      ""Actual Loops"": 1,
                                      ""Inner Unique"": true,
                                      ""Hash Cond"": ""(h.id_cliente = cli.id_cliente)"",
                                      ""Plans"": [
                                        {
                                          ""Node Type"": ""Merge Join"",
                                          ""Parent Relationship"": ""Outer"",
                                          ""Parallel Aware"": false,
                                          ""Async Capable"": false,
                                          ""Join Type"": ""Inner"",
                                          ""Actual Rows"": 1000,
                                          ""Actual Loops"": 1,
                                          ""Inner Unique"": true,
                                          ""Merge Cond"": ""(ped.id_pedido = h.id_pedido)"",
                                          ""Plans"": [
                                            {
                                              ""Node Type"": ""Index Scan"",
                                              ""Parent Relationship"": ""Outer"",
                                              ""Parallel Aware"": false,
                                              ""Async Capable"": false,
                                              ""Scan Direction"": ""Forward"",
                                              ""Index Name"": ""pedidos_pkey"",
                                              ""Relation Name"": ""pedidos"",
                                              ""Alias"": ""ped"",
                                              ""Actual Rows"": 1000,
                                              ""Actual Loops"": 1,
                                              ""Filter"": ""(fecha >= (CURRENT_DATE - '3 years'::interval))"",
                                              ""Rows Removed by Filter"": 0
                                            },
                                            {
                                              ""Node Type"": ""Index Scan"",
                                              ""Parent Relationship"": ""Inner"",
                                              ""Parallel Aware"": false,
                                              ""Async Capable"": false,
                                              ""Scan Direction"": ""Forward"",
                                              ""Index Name"": ""hace_pkey"",
                                              ""Relation Name"": ""hace"",
                                              ""Alias"": ""h"",
                                              ""Actual Rows"": 1000,
                                              ""Actual Loops"": 1
                                            }
                                          ]
                                        },
                                        {
                                          ""Node Type"": ""Hash"",
                                          ""Parent Relationship"": ""Inner"",
                                          ""Parallel Aware"": false,
                                          ""Async Capable"": false,
                                          ""Actual Rows"": 500,
                                          ""Actual Loops"": 1,
                                          ""Hash Buckets"": 1024,
                                          ""Original Hash Buckets"": 1024,
                                          ""Hash Batches"": 1,
                                          ""Original Hash Batches"": 1,
                                          ""Peak Memory Usage"": 46,
                                          ""Plans"": [
                                            {
                                              ""Node Type"": ""Index Scan"",
                                              ""Parent Relationship"": ""Outer"",
                                              ""Parallel Aware"": false,
                                              ""Async Capable"": false,
                                              ""Scan Direction"": ""Forward"",
                                              ""Index Name"": ""clientes_pkey"",
                                              ""Relation Name"": ""clientes"",
                                              ""Alias"": ""cli"",
                                              ""Actual Rows"": 500,
                                              ""Actual Loops"": 1
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      ""Node Type"": ""Index Scan"",
                                      ""Parent Relationship"": ""Inner"",
                                      ""Parallel Aware"": false,
                                      ""Async Capable"": false,
                                      ""Scan Direction"": ""Forward"",
                                      ""Index Name"": ""idx_detallespedido_pedido_hash"",
                                      ""Relation Name"": ""detallespedido"",
                                      ""Alias"": ""dp"",
                                      ""Actual Rows"": 3,
                                      ""Actual Loops"": 1000,
                                      ""Index Cond"": ""(id_pedido = ped.id_pedido)"",
                                      ""Rows Removed by Index Recheck"": 0
                                    }
                                  ]
                                },
                                {
                                  ""Node Type"": ""Hash"",
                                  ""Parent Relationship"": ""Inner"",
                                  ""Parallel Aware"": false,
                                  ""Async Capable"": false,
                                  ""Actual Rows"": 3000,
                                  ""Actual Loops"": 1,
                                  ""Hash Buckets"": 4096,
                                  ""Original Hash Buckets"": 4096,
                                  ""Hash Batches"": 1,
                                  ""Original Hash Batches"": 1,
                                  ""Peak Memory Usage"": 212,
                                  ""Plans"": [
                                    {
                                      ""Node Type"": ""Index Scan"",
                                      ""Parent Relationship"": ""Outer"",
                                      ""Parallel Aware"": false,
                                      ""Async Capable"": false,
                                      ""Scan Direction"": ""Forward"",
                                      ""Index Name"": ""productos_pkey"",
                                      ""Relation Name"": ""productos"",
                                      ""Alias"": ""p"",
                                      ""Actual Rows"": 3000,
                                      ""Actual Loops"": 1
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              ""Node Type"": ""Hash"",
                              ""Parent Relationship"": ""Inner"",
                              ""Parallel Aware"": false,
                              ""Async Capable"": false,
                              ""Actual Rows"": 1000,
                              ""Actual Loops"": 1,
                              ""Hash Buckets"": 1024,
                              ""Original Hash Buckets"": 1024,
                              ""Hash Batches"": 1,
                              ""Original Hash Batches"": 1,
                              ""Peak Memory Usage"": 65,
                              ""Plans"": [
                                {
                                  ""Node Type"": ""Index Scan"",
                                  ""Parent Relationship"": ""Outer"",
                                  ""Parallel Aware"": false,
                                  ""Async Capable"": false,
                                  ""Scan Direction"": ""Forward"",
                                  ""Index Name"": ""proveedores_pkey"",
                                  ""Relation Name"": ""proveedores"",
                                  ""Alias"": ""prov"",
                                  ""Actual Rows"": 1000,
                                  ""Actual Loops"": 1
                                }
                              ]
                            }
                          ]
                        },
                        {
                          ""Node Type"": ""Hash"",
                          ""Parent Relationship"": ""Inner"",
                          ""Parallel Aware"": false,
                          ""Async Capable"": false,
                          ""Actual Rows"": 1000,
                          ""Actual Loops"": 1,
                          ""Hash Buckets"": 1024,
                          ""Original Hash Buckets"": 1024,
                          ""Hash Batches"": 1,
                          ""Original Hash Batches"": 1,
                          ""Peak Memory Usage"": 62,
                          ""Plans"": [
                            {
                              ""Node Type"": ""Merge Join"",
                              ""Parent Relationship"": ""Outer"",
                              ""Parallel Aware"": false,
                              ""Async Capable"": false,
                              ""Join Type"": ""Inner"",
                              ""Actual Rows"": 1000,
                              ""Actual Loops"": 1,
                              ""Inner Unique"": true,
                              ""Merge Cond"": ""(kio.id_kiosko = a.id_kiosko)"",
                              ""Plans"": [
                                {
                                  ""Node Type"": ""Index Scan"",
                                  ""Parent Relationship"": ""Outer"",
                                  ""Parallel Aware"": false,
                                  ""Async Capable"": false,
                                  ""Scan Direction"": ""Forward"",
                                  ""Index Name"": ""kiosko_pkey"",
                                  ""Relation Name"": ""kiosko"",
                                  ""Alias"": ""kio"",
                                  ""Actual Rows"": 1000,
                                  ""Actual Loops"": 1
                                },
                                {
                                  ""Node Type"": ""Index Scan"",
                                  ""Parent Relationship"": ""Inner"",
                                  ""Parallel Aware"": false,
                                  ""Async Capable"": false,
                                  ""Scan Direction"": ""Forward"",
                                  ""Index Name"": ""administra_pkey"",
                                  ""Relation Name"": ""administra"",
                                  ""Alias"": ""a"",
                                  ""Actual Rows"": 1000,
                                  ""Actual Loops"": 1
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      ""Node Type"": ""Memoize"",
                      ""Parent Relationship"": ""Inner"",
                      ""Parallel Aware"": false,
                      ""Async Capable"": false,
                      ""Actual Rows"": 1,
                      ""Actual Loops"": 5930,
                      ""Cache Key"": ""ped.id_pedido"",
                      ""Cache Mode"": ""logical"",
                      ""Cache Hits"": 4930,
                      ""Cache Misses"": 1000,
                      ""Cache Evictions"": 0,
                      ""Cache Overflows"": 0,
                      ""Peak Memory Usage"": 110,
                      ""Plans"": [
                        {
                          ""Node Type"": ""Index Scan"",
                          ""Parent Relationship"": ""Outer"",
                          ""Parallel Aware"": false,
                          ""Async Capable"": false,
                          ""Scan Direction"": ""Forward"",
                          ""Index Name"": ""idx_pagos_id_pedido_hash"",
                          ""Relation Name"": ""pagos"",
                          ""Alias"": ""pa"",
                          ""Actual Rows"": 1,
                          ""Actual Loops"": 1000,
                          ""Index Cond"": ""(id_pedido = ped.id_pedido)"",
                          ""Rows Removed by Index Recheck"": 0
                        }
                      ]
                    }
                  ]
                },
                {
                  ""Node Type"": ""Hash"",
                  ""Parent Relationship"": ""Inner"",
                  ""Parallel Aware"": false,
                  ""Async Capable"": false,
                  ""Actual Rows"": 798,
                  ""Actual Loops"": 1,
                  ""Hash Buckets"": 1024,
                  ""Original Hash Buckets"": 1024,
                  ""Hash Batches"": 1,
                  ""Original Hash Batches"": 1,
                  ""Peak Memory Usage"": 37,
                  ""Plans"": [
                    {
                      ""Node Type"": ""Aggregate"",
                      ""Strategy"": ""Hashed"",
                      ""Partial Mode"": ""Simple"",
                      ""Parent Relationship"": ""Outer"",
                      ""Parallel Aware"": false,
                      ""Async Capable"": false,
                      ""Actual Rows"": 798,
                      ""Actual Loops"": 1,
                      ""Group Key"": [""dp_sub.id_pedido""],
                      ""HashAgg Batches"": 1,
                      ""Peak Memory Usage"": 73,
                      ""Disk Usage"": 0,
                      ""Plans"": [
                        {
                          ""Node Type"": ""Bitmap Heap Scan"",
                          ""Parent Relationship"": ""Outer"",
                          ""Parallel Aware"": false,
                          ""Async Capable"": false,
                          ""Relation Name"": ""detallespedido"",
                          ""Alias"": ""dp_sub"",
                          ""Actual Rows"": 1469,
                          ""Actual Loops"": 1,
                          ""Recheck Cond"": ""(cantidad_solicitada > 5)"",
                          ""Rows Removed by Index Recheck"": 0,
                          ""Exact Heap Blocks"": 22,
                          ""Lossy Heap Blocks"": 0,
                          ""Plans"": [
                            {
                              ""Node Type"": ""Bitmap Index Scan"",
                              ""Parent Relationship"": ""Outer"",
                              ""Parallel Aware"": false,
                              ""Async Capable"": false,
                              ""Index Name"": ""idx_detallespedido_cantidad_btree"",
                              ""Actual Rows"": 1469,
                              ""Actual Loops"": 1,
                              ""Index Cond"": ""(cantidad_solicitada > 5)""
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    ""Triggers"": [
    ]
  }
]"
