"QUERY PLAN"
"Sort  (cost=20155.50..20205.14 rows=19856 width=173) (actual time=1568.167..1568.245 rows=408 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (EXTRACT(year FROM ped.fecha))"
"  Sort Method: quicksort  Memory: 87kB"
"  ->  GroupAggregate  (cost=16305.69..18738.05 rows=19856 width=173) (actual time=1156.919..1567.100 rows=408 loops=1)"
"        Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"        Filter: (sum(dp.cantidad_solicitada) > 10)"
"        Rows Removed by Filter: 70642"
"        ->  Sort  (cost=16305.69..16454.61 rows=59568 width=143) (actual time=1156.686..1419.543 rows=71780 loops=1)"
"              Sort Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"              Sort Method: external merge  Disk: 9248kB"
"              ->  Hash Join  (cost=3420.70..7304.28 rows=59568 width=143) (actual time=44.833..255.423 rows=71780 loops=1)"
"                    Hash Cond: (ped.id_pedido = dp_sub.id_pedido)"
"                    ->  Hash Left Join  (cost=2593.52..5509.12 rows=59568 width=127) (actual time=32.139..191.802 rows=81746 loops=1)"
"                          Hash Cond: (ped.id_pedido = pa.id_pedido)"
"                          ->  Hash Join  (cost=2281.52..3856.84 rows=59568 width=122) (actual time=28.529..149.979 rows=59574 loops=1)"
"                                Hash Cond: (h.id_cliente = cli.id_cliente)"
"                                ->  Hash Join  (cost=2192.99..3023.71 rows=29784 width=71) (actual time=27.302..120.129 rows=29787 loops=1)"
"                                      Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                      ->  Hash Join  (cost=1800.99..2553.49 rows=29784 width=55) (actual time=24.396..94.662 rows=29787 loops=1)"
"                                            Hash Cond: (dp.id_producto = p.id_producto)"
"                                            ->  Hash Join  (cost=640.99..1315.30 rows=29784 width=34) (actual time=8.798..51.134 rows=29787 loops=1)"
"                                                  Hash Cond: (ped.id_pedido = h.id_pedido)"
"                                                  ->  Hash Join  (cost=370.99..967.08 rows=29784 width=26) (actual time=6.277..32.702 rows=29787 loops=1)"
"                                                        Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                        ->  Seq Scan on detallespedido dp  (cost=0.00..517.87 rows=29787 width=18) (actual time=0.024..6.481 rows=29787 loops=1)"
"                                                        ->  Hash  (cost=246.00..246.00 rows=9999 width=8) (actual time=6.167..6.169 rows=10000 loops=1)"
"                                                              Buckets: 16384  Batches: 1  Memory Usage: 519kB"
"                                                              ->  Seq Scan on pedidos ped  (cost=0.00..246.00 rows=9999 width=8) (actual time=0.020..4.207 rows=10000 loops=1)"
"                                                                    Filter: (fecha >= (CURRENT_DATE - '3 years'::interval))"
"                                                  ->  Hash  (cost=145.00..145.00 rows=10000 width=8) (actual time=2.436..2.437 rows=10000 loops=1)"
"                                                        Buckets: 16384  Batches: 1  Memory Usage: 519kB"
"                                                        ->  Seq Scan on hace h  (cost=0.00..145.00 rows=10000 width=8) (actual time=0.025..0.943 rows=10000 loops=1)"
"                                            ->  Hash  (cost=785.00..785.00 rows=30000 width=29) (actual time=15.437..15.438 rows=30000 loops=1)"
"                                                  Buckets: 32768  Batches: 1  Memory Usage: 2076kB"
"                                                  ->  Seq Scan on productos p  (cost=0.00..785.00 rows=30000 width=29) (actual time=0.027..5.702 rows=30000 loops=1)"
"                                      ->  Hash  (cost=267.00..267.00 rows=10000 width=24) (actual time=2.838..2.839 rows=10000 loops=1)"
"                                            Buckets: 16384  Batches: 1  Memory Usage: 694kB"
"                                            ->  Seq Scan on proveedores prov  (cost=0.00..267.00 rows=10000 width=24) (actual time=0.011..1.372 rows=10000 loops=1)"
"                                ->  Hash  (cost=76.03..76.03 rows=1000 width=63) (actual time=1.203..1.209 rows=1000 loops=1)"
"                                      Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                      ->  Hash Join  (cost=46.75..76.03 rows=1000 width=63) (actual time=0.542..1.001 rows=1000 loops=1)"
"                                            Hash Cond: (a.id_cliente = cli.id_cliente)"
"                                            ->  Hash Join  (cost=27.50..54.14 rows=1000 width=21) (actual time=0.244..0.527 rows=1000 loops=1)"
"                                                  Hash Cond: (kio.id_kiosko = a.id_kiosko)"
"                                                  ->  Seq Scan on kiosko kio  (cost=0.00..24.00 rows=1000 width=21) (actual time=0.053..0.138 rows=1000 loops=1)"
"                                                  ->  Hash  (cost=15.00..15.00 rows=1000 width=8) (actual time=0.173..0.174 rows=1000 loops=1)"
"                                                        Buckets: 1024  Batches: 1  Memory Usage: 48kB"
"                                                        ->  Seq Scan on administra a  (cost=0.00..15.00 rows=1000 width=8) (actual time=0.021..0.083 rows=1000 loops=1)"
"                                            ->  Hash  (cost=13.00..13.00 rows=500 width=42) (actual time=0.248..0.249 rows=500 loops=1)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 46kB"
"                                                  ->  Seq Scan on clientes cli  (cost=0.00..13.00 rows=500 width=42) (actual time=0.038..0.141 rows=500 loops=1)"
"                          ->  Hash  (cost=187.00..187.00 rows=10000 width=9) (actual time=3.521..3.522 rows=10000 loops=1)"
"                                Buckets: 16384  Batches: 1  Memory Usage: 558kB"
"                                ->  Seq Scan on pagos pa  (cost=0.00..187.00 rows=10000 width=9) (actual time=0.038..1.708 rows=10000 loops=1)"
"                    ->  Hash  (cost=717.59..717.59 rows=8767 width=4) (actual time=12.592..12.594 rows=8010 loops=1)"
"                          Buckets: 16384  Batches: 1  Memory Usage: 410kB"
"                          ->  HashAggregate  (cost=629.92..717.59 rows=8767 width=4) (actual time=10.001..11.346 rows=8010 loops=1)"
"                                Group Key: dp_sub.id_pedido"
"                                Batches: 1  Memory Usage: 913kB"
"                                ->  Seq Scan on detallespedido dp_sub  (cost=0.00..592.34 rows=15034 width=4) (actual time=0.029..5.728 rows=15034 loops=1)"
"                                      Filter: (cantidad_solicitada > 5)"
"                                      Rows Removed by Filter: 14753"
"Planning Time: 5.725 ms"
"Execution Time: 1574.746 ms"
