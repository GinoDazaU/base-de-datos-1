"QUERY PLAN"
"Sort  (cost=20145.16..20194.80 rows=19858 width=173) (actual time=326.216..326.240 rows=408 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (EXTRACT(year FROM ped.fecha))"
"  Sort Method: quicksort  Memory: 87kB"
"  ->  GroupAggregate  (cost=16294.95..18727.55 rows=19858 width=173) (actual time=236.211..326.006 rows=408 loops=1)"
"        Group Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"        Filter: (sum(dp.cantidad_solicitada) > 10)"
"        Rows Removed by Filter: 70642"
"        ->  Sort  (cost=16294.95..16443.88 rows=59574 width=143) (actual time=236.171..285.105 rows=71780 loops=1)"
"              Sort Key: cli.nombre, cli.correo, kio.nombre, prov.nombre, p.nombre, pa.monto, (EXTRACT(year FROM ped.fecha))"
"              Sort Method: external merge  Disk: 9232kB"
"              ->  Hash Join  (cost=3409.10..7293.01 rows=59574 width=143) (actual time=19.623..86.260 rows=71780 loops=1)"
"                    Hash Cond: (ped.id_pedido = dp_sub.id_pedido)"
"                    ->  Hash Left Join  (cost=2589.53..5505.37 rows=59574 width=127) (actual time=14.804..65.531 rows=81746 loops=1)"
"                          Hash Cond: (ped.id_pedido = pa.id_pedido)"
"                          ->  Hash Join  (cost=2277.53..3852.95 rows=59574 width=122) (actual time=13.160..51.319 rows=59574 loops=1)"
"                                Hash Cond: (h.id_cliente = cli.id_cliente)"
"                                ->  Hash Join  (cost=2189.00..3019.74 rows=29787 width=71) (actual time=12.445..42.355 rows=29787 loops=1)"
"                                      Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                      ->  Hash Join  (cost=1797.00..2549.52 rows=29787 width=55) (actual time=10.353..32.665 rows=29787 loops=1)"
"                                            Hash Cond: (dp.id_producto = p.id_producto)"
"                                            ->  Hash Join  (cost=641.00..1315.32 rows=29787 width=34) (actual time=3.763..16.410 rows=29787 loops=1)"
"                                                  Hash Cond: (ped.id_pedido = h.id_pedido)"
"                                                  ->  Hash Join  (cost=371.00..967.09 rows=29787 width=26) (actual time=2.077..9.669 rows=29787 loops=1)"
"                                                        Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                        ->  Seq Scan on detallespedido dp  (cost=0.00..517.87 rows=29787 width=18) (actual time=0.005..1.824 rows=29787 loops=1)"
"                                                        ->  Hash  (cost=246.00..246.00 rows=10000 width=8) (actual time=2.006..2.007 rows=10000 loops=1)"
"                                                              Buckets: 16384  Batches: 1  Memory Usage: 519kB"
"                                                              ->  Seq Scan on pedidos ped  (cost=0.00..246.00 rows=10000 width=8) (actual time=0.006..1.127 rows=10000 loops=1)"
"                                                                    Filter: (fecha >= (CURRENT_DATE - '3 years'::interval))"
"                                                  ->  Hash  (cost=145.00..145.00 rows=10000 width=8) (actual time=1.635..1.636 rows=10000 loops=1)"
"                                                        Buckets: 16384  Batches: 1  Memory Usage: 519kB"
"                                                        ->  Seq Scan on hace h  (cost=0.00..145.00 rows=10000 width=8) (actual time=0.003..0.607 rows=10000 loops=1)"
"                                            ->  Hash  (cost=781.00..781.00 rows=30000 width=29) (actual time=6.492..6.492 rows=30000 loops=1)"
"                                                  Buckets: 32768  Batches: 1  Memory Usage: 2068kB"
"                                                  ->  Seq Scan on productos p  (cost=0.00..781.00 rows=30000 width=29) (actual time=0.004..2.675 rows=30000 loops=1)"
"                                      ->  Hash  (cost=267.00..267.00 rows=10000 width=24) (actual time=2.041..2.041 rows=10000 loops=1)"
"                                            Buckets: 16384  Batches: 1  Memory Usage: 694kB"
"                                            ->  Seq Scan on proveedores prov  (cost=0.00..267.00 rows=10000 width=24) (actual time=0.004..0.907 rows=10000 loops=1)"
"                                ->  Hash  (cost=76.03..76.03 rows=1000 width=63) (actual time=0.699..0.702 rows=1000 loops=1)"
"                                      Buckets: 1024  Batches: 1  Memory Usage: 104kB"
"                                      ->  Hash Join  (cost=46.75..76.03 rows=1000 width=63) (actual time=0.253..0.556 rows=1000 loops=1)"
"                                            Hash Cond: (a.id_cliente = cli.id_cliente)"
"                                            ->  Hash Join  (cost=27.50..54.14 rows=1000 width=21) (actual time=0.129..0.314 rows=1000 loops=1)"
"                                                  Hash Cond: (kio.id_kiosko = a.id_kiosko)"
"                                                  ->  Seq Scan on kiosko kio  (cost=0.00..24.00 rows=1000 width=21) (actual time=0.003..0.063 rows=1000 loops=1)"
"                                                  ->  Hash  (cost=15.00..15.00 rows=1000 width=8) (actual time=0.111..0.111 rows=1000 loops=1)"
"                                                        Buckets: 1024  Batches: 1  Memory Usage: 48kB"
"                                                        ->  Seq Scan on administra a  (cost=0.00..15.00 rows=1000 width=8) (actual time=0.003..0.043 rows=1000 loops=1)"
"                                            ->  Hash  (cost=13.00..13.00 rows=500 width=42) (actual time=0.113..0.113 rows=500 loops=1)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 46kB"
"                                                  ->  Seq Scan on clientes cli  (cost=0.00..13.00 rows=500 width=42) (actual time=0.006..0.045 rows=500 loops=1)"
"                          ->  Hash  (cost=187.00..187.00 rows=10000 width=9) (actual time=1.589..1.589 rows=10000 loops=1)"
"                                Buckets: 16384  Batches: 1  Memory Usage: 558kB"
"                                ->  Seq Scan on pagos pa  (cost=0.00..187.00 rows=10000 width=9) (actual time=0.008..0.668 rows=10000 loops=1)"
"                    ->  Hash  (cost=709.98..709.98 rows=8767 width=4) (actual time=4.761..4.762 rows=8010 loops=1)"
"                          Buckets: 16384  Batches: 1  Memory Usage: 410kB"
"                          ->  HashAggregate  (cost=622.31..709.98 rows=8767 width=4) (actual time=3.431..4.017 rows=8010 loops=1)"
"                                Group Key: dp_sub.id_pedido"
"                                Batches: 1  Memory Usage: 913kB"
"                                ->  Bitmap Heap Scan on detallespedido dp_sub  (cost=176.80..584.73 rows=15034 width=4) (actual time=0.366..1.809 rows=15034 loops=1)"
"                                      Recheck Cond: (cantidad_solicitada > 5)"
"                                      Heap Blocks: exact=220"
"                                      ->  Bitmap Index Scan on idx_detallespedido_cantidad_btree  (cost=0.00..173.04 rows=15034 width=0) (actual time=0.342..0.342 rows=15034 loops=1)"
"                                            Index Cond: (cantidad_solicitada > 5)"
"Planning Time: 3.886 ms"
"Execution Time: 328.739 ms"
