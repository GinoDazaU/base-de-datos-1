"QUERY PLAN"
"Sort  (cost=11699.51..11773.97 rows=29784 width=153) (actual time=864.799..867.474 rows=18940 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (count(dp.id_producto)) DESC"
"  Sort Method: quicksort  Memory: 2750kB"
"  ->  GroupAggregate  (cost=5953.36..7144.72 rows=29784 width=153) (actual time=786.411..841.553 rows=18940 loops=1)"
"        Group Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre"
"        ->  Sort  (cost=5953.36..6027.82 rows=29784 width=95) (actual time=786.372..795.839 rows=29787 loops=1)"
"              Sort Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre, ped.id_pedido"
"              Sort Method: quicksort  Memory: 3693kB"
"              ->  Hash Left Join  (cost=2752.99..3740.07 rows=29784 width=95) (actual time=18.943..137.040 rows=29787 loops=1)"
"                    Hash Cond: (p.id_producto = c.id_producto)"
"                    ->  Hash Left Join  (cost=2472.99..3381.88 rows=29784 width=75) (actual time=17.276..112.535 rows=29787 loops=1)"
"                          Hash Cond: (p.id_producto = g.id_producto)"
"                          ->  Hash Left Join  (cost=2192.99..3023.69 rows=29784 width=71) (actual time=15.598..94.919 rows=29787 loops=1)"
"                                Hash Cond: (p.id_producto = a.id_producto)"
"                                ->  Hash Join  (cost=1922.99..2675.49 rows=29784 width=67) (actual time=13.914..77.208 rows=29787 loops=1)"
"                                      Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                      ->  Hash Join  (cost=1530.99..2205.28 rows=29784 width=51) (actual time=11.218..56.632 rows=29787 loops=1)"
"                                            Hash Cond: (dp.id_producto = p.id_producto)"
"                                            ->  Hash Join  (cost=370.99..967.08 rows=29784 width=14) (actual time=2.858..23.744 rows=29787 loops=1)"
"                                                  Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                                  ->  Seq Scan on detallespedido dp  (cost=0.00..517.87 rows=29787 width=14) (actual time=0.021..4.634 rows=29787 loops=1)"
"                                                  ->  Hash  (cost=246.00..246.00 rows=9999 width=4) (actual time=2.761..2.764 rows=10000 loops=1)"
"                                                        Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                                                        ->  Seq Scan on pedidos ped  (cost=0.00..246.00 rows=9999 width=4) (actual time=0.013..1.847 rows=10000 loops=1)"
"                                                              Filter: (fecha >= (CURRENT_DATE - '5 years'::interval))"
"                                            ->  Hash  (cost=785.00..785.00 rows=30000 width=37) (actual time=8.236..8.237 rows=30000 loops=1)"
"                                                  Buckets: 32768  Batches: 1  Memory Usage: 2349kB"
"                                                  ->  Seq Scan on productos p  (cost=0.00..785.00 rows=30000 width=37) (actual time=0.013..3.732 rows=30000 loops=1)"
"                                      ->  Hash  (cost=267.00..267.00 rows=10000 width=24) (actual time=2.612..2.613 rows=10000 loops=1)"
"                                            Buckets: 16384  Batches: 1  Memory Usage: 694kB"
"                                            ->  Seq Scan on proveedores prov  (cost=0.00..267.00 rows=10000 width=24) (actual time=0.026..1.235 rows=10000 loops=1)"
"                                ->  Hash  (cost=145.00..145.00 rows=10000 width=4) (actual time=1.613..1.614 rows=10000 loops=1)"
"                                      Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                                      ->  Seq Scan on agua a  (cost=0.00..145.00 rows=10000 width=4) (actual time=0.023..0.737 rows=10000 loops=1)"
"                          ->  Hash  (cost=155.00..155.00 rows=10000 width=4) (actual time=1.612..1.613 rows=10000 loops=1)"
"                                Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                                ->  Seq Scan on gaseosas g  (cost=0.00..155.00 rows=10000 width=4) (actual time=0.015..0.739 rows=10000 loops=1)"
"                    ->  Hash  (cost=155.00..155.00 rows=10000 width=4) (actual time=1.597..1.597 rows=10000 loops=1)"
"                          Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                          ->  Seq Scan on cervezas c  (cost=0.00..155.00 rows=10000 width=4) (actual time=0.013..0.744 rows=10000 loops=1)"
"Planning Time: 3.218 ms"
"Execution Time: 870.229 ms"
