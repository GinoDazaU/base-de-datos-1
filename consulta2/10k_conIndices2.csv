"QUERY PLAN"
"Sort  (cost=11699.67..11774.14 rows=29787 width=153) (actual time=161.194..161.972 rows=18940 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (count(dp.id_producto)) DESC"
"  Sort Method: quicksort  Memory: 2744kB"
"  ->  GroupAggregate  (cost=5949.66..7141.14 rows=29787 width=153) (actual time=137.389..153.612 rows=18940 loops=1)"
"        Group Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre"
"        ->  Sort  (cost=5949.66..6024.12 rows=29787 width=95) (actual time=137.367..139.209 rows=29787 loops=1)"
"              Sort Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre, ped.id_pedido"
"              Sort Method: quicksort  Memory: 3678kB"
"              ->  Hash Left Join  (cost=2749.00..3736.13 rows=29787 width=95) (actual time=15.654..45.970 rows=29787 loops=1)"
"                    Hash Cond: (p.id_producto = c.id_producto)"
"                    ->  Hash Left Join  (cost=2469.00..3377.92 rows=29787 width=75) (actual time=14.309..40.465 rows=29787 loops=1)"
"                          Hash Cond: (p.id_producto = g.id_producto)"
"                          ->  Hash Left Join  (cost=2189.00..3019.72 rows=29787 width=71) (actual time=12.967..34.978 rows=29787 loops=1)"
"                                Hash Cond: (p.id_producto = a.id_producto)"
"                                ->  Hash Join  (cost=1919.00..2671.52 rows=29787 width=67) (actual time=11.235..29.084 rows=29787 loops=1)"
"                                      Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                      ->  Hash Join  (cost=1548.00..2222.30 rows=29787 width=67) (actual time=9.290..22.920 rows=29787 loops=1)"
"                                            Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                            ->  Hash Join  (cost=1156.00..1752.07 rows=29787 width=51) (actual time=7.124..15.802 rows=29787 loops=1)"
"                                                  Hash Cond: (dp.id_producto = p.id_producto)"
"                                                  ->  Seq Scan on detallespedido dp  (cost=0.00..517.87 rows=29787 width=14) (actual time=0.004..1.675 rows=29787 loops=1)"
"                                                  ->  Hash  (cost=781.00..781.00 rows=30000 width=37) (actual time=7.012..7.013 rows=30000 loops=1)"
"                                                        Buckets: 32768  Batches: 1  Memory Usage: 2334kB"
"                                                        ->  Seq Scan on productos p  (cost=0.00..781.00 rows=30000 width=37) (actual time=0.005..2.813 rows=30000 loops=1)"
"                                            ->  Hash  (cost=267.00..267.00 rows=10000 width=24) (actual time=2.110..2.110 rows=10000 loops=1)"
"                                                  Buckets: 16384  Batches: 1  Memory Usage: 694kB"
"                                                  ->  Seq Scan on proveedores prov  (cost=0.00..267.00 rows=10000 width=24) (actual time=0.003..0.869 rows=10000 loops=1)"
"                                      ->  Hash  (cost=246.00..246.00 rows=10000 width=4) (actual time=1.892..1.893 rows=10000 loops=1)"
"                                            Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                                            ->  Seq Scan on pedidos ped  (cost=0.00..246.00 rows=10000 width=4) (actual time=0.007..1.109 rows=10000 loops=1)"
"                                                  Filter: (fecha >= (CURRENT_DATE - '5 years'::interval))"
"                                ->  Hash  (cost=145.00..145.00 rows=10000 width=4) (actual time=1.643..1.643 rows=10000 loops=1)"
"                                      Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                                      ->  Seq Scan on agua a  (cost=0.00..145.00 rows=10000 width=4) (actual time=0.011..0.662 rows=10000 loops=1)"
"                          ->  Hash  (cost=155.00..155.00 rows=10000 width=4) (actual time=1.291..1.291 rows=10000 loops=1)"
"                                Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                                ->  Seq Scan on gaseosas g  (cost=0.00..155.00 rows=10000 width=4) (actual time=0.004..0.539 rows=10000 loops=1)"
"                    ->  Hash  (cost=155.00..155.00 rows=10000 width=4) (actual time=1.292..1.293 rows=10000 loops=1)"
"                          Buckets: 16384  Batches: 1  Memory Usage: 480kB"
"                          ->  Seq Scan on cervezas c  (cost=0.00..155.00 rows=10000 width=4) (actual time=0.004..0.558 rows=10000 loops=1)"
"Planning Time: 1.872 ms"
"Execution Time: 162.992 ms"
