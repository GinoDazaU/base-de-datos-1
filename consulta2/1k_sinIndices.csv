"QUERY PLAN"
"Sort  (cost=837.54..844.95 rows=2965 width=152) (actual time=43.831..43.931 rows=1859 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (count(dp.id_producto)) DESC"
"  Sort Method: quicksort  Memory: 244kB"
"  ->  GroupAggregate  (cost=547.95..666.55 rows=2965 width=152) (actual time=40.568..42.958 rows=1859 loops=1)"
"        Group Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre"
"        ->  Sort  (cost=547.95..555.36 rows=2965 width=94) (actual time=40.528..40.718 rows=2965 loops=1)"
"              Sort Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre, ped.id_pedido"
"              Sort Method: quicksort  Memory: 385kB"
"              ->  Hash Left Join  (cost=278.50..376.96 rows=2965 width=94) (actual time=3.030..8.043 rows=2965 loops=1)"
"                    Hash Cond: (p.id_producto = c.id_producto)"
"                    ->  Hash Left Join  (cost=250.00..340.67 rows=2965 width=74) (actual time=2.853..7.194 rows=2965 loops=1)"
"                          Hash Cond: (p.id_producto = g.id_producto)"
"                          ->  Hash Left Join  (cost=221.50..304.37 rows=2965 width=70) (actual time=2.671..6.308 rows=2965 loops=1)"
"                                Hash Cond: (p.id_producto = a.id_producto)"
"                                ->  Hash Join  (cost=194.00..269.08 rows=2965 width=66) (actual time=2.482..5.265 rows=2965 loops=1)"
"                                      Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                      ->  Hash Join  (cost=156.00..223.26 rows=2965 width=66) (actual time=2.144..3.980 rows=2965 loops=1)"
"                                            Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                            ->  Hash Join  (cost=116.50..175.94 rows=2965 width=50) (actual time=1.870..3.075 rows=2965 loops=1)"
"                                                  Hash Cond: (dp.id_producto = p.id_producto)"
"                                                  ->  Seq Scan on detallespedido dp  (cost=0.00..51.65 rows=2965 width=14) (actual time=0.010..0.250 rows=2965 loops=1)"
"                                                  ->  Hash  (cost=79.00..79.00 rows=3000 width=36) (actual time=1.837..1.839 rows=3000 loops=1)"
"                                                        Buckets: 4096  Batches: 1  Memory Usage: 242kB"
"                                                        ->  Seq Scan on productos p  (cost=0.00..79.00 rows=3000 width=36) (actual time=0.009..0.636 rows=3000 loops=1)"
"                                            ->  Hash  (cost=27.00..27.00 rows=1000 width=24) (actual time=0.243..0.244 rows=1000 loops=1)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 65kB"
"                                                  ->  Seq Scan on proveedores prov  (cost=0.00..27.00 rows=1000 width=24) (actual time=0.011..0.122 rows=1000 loops=1)"
"                                      ->  Hash  (cost=25.50..25.50 rows=1000 width=4) (actual time=0.319..0.320 rows=1000 loops=1)"
"                                            Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                                            ->  Seq Scan on pedidos ped  (cost=0.00..25.50 rows=1000 width=4) (actual time=0.030..0.223 rows=1000 loops=1)"
"                                                  Filter: (fecha >= (CURRENT_DATE - '5 years'::interval))"
"                                ->  Hash  (cost=15.00..15.00 rows=1000 width=4) (actual time=0.178..0.179 rows=1000 loops=1)"
"                                      Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                                      ->  Seq Scan on agua a  (cost=0.00..15.00 rows=1000 width=4) (actual time=0.014..0.085 rows=1000 loops=1)"
"                          ->  Hash  (cost=16.00..16.00 rows=1000 width=4) (actual time=0.172..0.173 rows=1000 loops=1)"
"                                Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                                ->  Seq Scan on gaseosas g  (cost=0.00..16.00 rows=1000 width=4) (actual time=0.011..0.083 rows=1000 loops=1)"
"                    ->  Hash  (cost=16.00..16.00 rows=1000 width=4) (actual time=0.167..0.168 rows=1000 loops=1)"
"                          Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                          ->  Seq Scan on cervezas c  (cost=0.00..16.00 rows=1000 width=4) (actual time=0.008..0.080 rows=1000 loops=1)"
"Planning Time: 3.660 ms"
"Execution Time: 44.298 ms"
