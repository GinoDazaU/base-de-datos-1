"QUERY PLAN"
"Sort  (cost=836.54..843.95 rows=2965 width=152) (actual time=13.543..13.603 rows=1859 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (count(dp.id_producto)) DESC"
"  Sort Method: quicksort  Memory: 243kB"
"  ->  GroupAggregate  (cost=546.95..665.55 rows=2965 width=152) (actual time=11.258..12.931 rows=1859 loops=1)"
"        Group Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre"
"        ->  Sort  (cost=546.95..554.36 rows=2965 width=94) (actual time=11.242..11.390 rows=2965 loops=1)"
"              Sort Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre, ped.id_pedido"
"              Sort Method: quicksort  Memory: 384kB"
"              ->  Hash Left Join  (cost=277.50..375.96 rows=2965 width=94) (actual time=1.813..4.674 rows=2965 loops=1)"
"                    Hash Cond: (p.id_producto = c.id_producto)"
"                    ->  Hash Left Join  (cost=249.00..339.67 rows=2965 width=74) (actual time=1.624..4.051 rows=2965 loops=1)"
"                          Hash Cond: (p.id_producto = g.id_producto)"
"                          ->  Hash Left Join  (cost=220.50..303.37 rows=2965 width=70) (actual time=1.439..3.452 rows=2965 loops=1)"
"                                Hash Cond: (p.id_producto = a.id_producto)"
"                                ->  Hash Join  (cost=193.00..268.08 rows=2965 width=66) (actual time=1.252..2.854 rows=2965 loops=1)"
"                                      Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                      ->  Hash Join  (cost=155.00..222.26 rows=2965 width=66) (actual time=1.042..2.234 rows=2965 loops=1)"
"                                            Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                            ->  Hash Join  (cost=115.50..174.94 rows=2965 width=50) (actual time=0.846..1.581 rows=2965 loops=1)"
"                                                  Hash Cond: (dp.id_producto = p.id_producto)"
"                                                  ->  Seq Scan on detallespedido dp  (cost=0.00..51.65 rows=2965 width=14) (actual time=0.002..0.168 rows=2965 loops=1)"
"                                                  ->  Hash  (cost=78.00..78.00 rows=3000 width=36) (actual time=0.823..0.823 rows=3000 loops=1)"
"                                                        Buckets: 4096  Batches: 1  Memory Usage: 240kB"
"                                                        ->  Seq Scan on productos p  (cost=0.00..78.00 rows=3000 width=36) (actual time=0.002..0.332 rows=3000 loops=1)"
"                                            ->  Hash  (cost=27.00..27.00 rows=1000 width=24) (actual time=0.183..0.183 rows=1000 loops=1)"
"                                                  Buckets: 1024  Batches: 1  Memory Usage: 65kB"
"                                                  ->  Seq Scan on proveedores prov  (cost=0.00..27.00 rows=1000 width=24) (actual time=0.002..0.075 rows=1000 loops=1)"
"                                      ->  Hash  (cost=25.50..25.50 rows=1000 width=4) (actual time=0.203..0.204 rows=1000 loops=1)"
"                                            Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                                            ->  Seq Scan on pedidos ped  (cost=0.00..25.50 rows=1000 width=4) (actual time=0.005..0.116 rows=1000 loops=1)"
"                                                  Filter: (fecha >= (CURRENT_DATE - '5 years'::interval))"
"                                ->  Hash  (cost=15.00..15.00 rows=1000 width=4) (actual time=0.170..0.170 rows=1000 loops=1)"
"                                      Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                                      ->  Seq Scan on agua a  (cost=0.00..15.00 rows=1000 width=4) (actual time=0.004..0.065 rows=1000 loops=1)"
"                          ->  Hash  (cost=16.00..16.00 rows=1000 width=4) (actual time=0.171..0.171 rows=1000 loops=1)"
"                                Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                                ->  Seq Scan on gaseosas g  (cost=0.00..16.00 rows=1000 width=4) (actual time=0.003..0.067 rows=1000 loops=1)"
"                    ->  Hash  (cost=16.00..16.00 rows=1000 width=4) (actual time=0.172..0.173 rows=1000 loops=1)"
"                          Buckets: 1024  Batches: 1  Memory Usage: 44kB"
"                          ->  Seq Scan on cervezas c  (cost=0.00..16.00 rows=1000 width=4) (actual time=0.004..0.068 rows=1000 loops=1)"
"Planning Time: 2.055 ms"
"Execution Time: 13.779 ms"
