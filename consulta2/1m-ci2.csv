"QUERY PLAN"
"Sort  (cost=1903726.34..1911223.36 rows=2998810 width=155) (actual time=19304.734..59240.724 rows=1896421 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (count(dp.id_producto)) DESC"
"  Sort Method: external merge  Disk: 174944kB"
"  ->  GroupAggregate  (cost=647899.76..1109615.98 rows=2998810 width=155) (actual time=14209.969..57526.607 rows=1896421 loops=1)"
"        Group Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre"
"        ->  Gather Merge  (cost=647899.76..997160.60 rows=2998810 width=97) (actual time=14209.929..56309.555 rows=2998810 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Sort  (cost=646899.74..650023.50 rows=1249504 width=97) (actual time=14161.286..14776.300 rows=999603 loops=3)"
"                    Sort Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre, ped.id_pedido"
"                    Sort Method: external merge  Disk: 84048kB"
"                    Worker 0:  Sort Method: external merge  Disk: 85728kB"
"                    Worker 1:  Sort Method: external merge  Disk: 84032kB"
"                    ->  Parallel Hash Join  (cost=171283.82..383701.19 rows=1249504 width=97) (actual time=2661.098..2930.034 rows=999603 loops=3)"
"                          Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                          ->  Parallel Hash Join  (cost=142795.82..322645.23 rows=1249504 width=61) (actual time=1892.115..2216.371 rows=999603 loops=3)"
"                                Hash Cond: (p.id_producto = dp.id_producto)"
"                                ->  Parallel Hash Left Join  (cost=48246.01..187676.28 rows=1250365 width=51) (actual time=978.197..1205.152 rows=1000000 loops=3)"
"                                      Hash Cond: (p.id_producto = c.id_producto)"
"                                      ->  Parallel Hash Left Join  (cost=31837.01..144377.07 rows=1250365 width=47) (actual time=617.597..781.259 rows=1000000 loops=3)"
"                                            Hash Cond: (p.id_producto = g.id_producto)"
"                                            ->  Parallel Hash Left Join  (cost=15428.00..101077.86 rows=1250365 width=43) (actual time=270.624..431.777 rows=1000000 loops=3)"
"                                                  Hash Cond: (p.id_producto = a.id_producto)"
"                                                  ->  Parallel Seq Scan on productos p  (cost=0.00..61201.65 rows=1250365 width=39) (actual time=0.044..81.198 rows=1000000 loops=3)"
"                                                  ->  Parallel Hash  (cost=8591.67..8591.67 rows=416667 width=4) (actual time=48.753..48.754 rows=333333 loops=3)"
"                                                        Buckets: 262144  Batches: 8  Memory Usage: 7008kB"
"                                                        ->  Parallel Seq Scan on agua a  (cost=0.00..8591.67 rows=416667 width=4) (actual time=0.031..19.202 rows=333333 loops=3)"
"                                            ->  Parallel Hash  (cost=9572.67..9572.67 rows=416667 width=4) (actual time=49.201..49.201 rows=333333 loops=3)"
"                                                  Buckets: 262144  Batches: 8  Memory Usage: 7008kB"
"                                                  ->  Parallel Seq Scan on gaseosas g  (cost=0.00..9572.67 rows=416667 width=4) (actual time=0.040..19.994 rows=333333 loops=3)"
"                                      ->  Parallel Hash  (cost=9572.67..9572.67 rows=416667 width=4) (actual time=49.198..49.198 rows=333333 loops=3)"
"                                            Buckets: 262144  Batches: 8  Memory Usage: 6976kB"
"                                            ->  Parallel Seq Scan on cervezas c  (cost=0.00..9572.67 rows=416667 width=4) (actual time=0.036..19.686 rows=333333 loops=3)"
"                                ->  Parallel Hash  (cost=72829.00..72829.00 rows=1249504 width=14) (actual time=518.557..518.559 rows=999603 loops=3)"
"                                      Buckets: 262144  Batches: 32  Memory Usage: 6496kB"
"                                      ->  Parallel Hash Join  (cost=21171.00..72829.00 rows=1249504 width=14) (actual time=261.416..398.510 rows=999603 loops=3)"
"                                            Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                                            ->  Parallel Seq Scan on detallespedido dp  (cost=0.00..34546.04 rows=1249504 width=14) (actual time=0.034..70.311 rows=999603 loops=3)"
"                                            ->  Parallel Hash  (cost=14334.67..14334.67 rows=416667 width=4) (actual time=71.960..71.961 rows=333333 loops=3)"
"                                                  Buckets: 262144  Batches: 8  Memory Usage: 7008kB"
"                                                  ->  Parallel Seq Scan on pedidos ped  (cost=0.00..14334.67 rows=416667 width=4) (actual time=0.045..37.221 rows=333333 loops=3)"
"                                                        Filter: (fecha >= (CURRENT_DATE - '5 years'::interval))"
"                          ->  Parallel Hash  (cost=20837.67..20837.67 rows=416667 width=24) (actual time=258.238..258.238 rows=333333 loops=3)"
"                                Buckets: 131072  Batches: 8  Memory Usage: 8384kB"
"                                ->  Parallel Seq Scan on proveedores prov  (cost=0.00..20837.67 rows=416667 width=24) (actual time=185.544..213.069 rows=333333 loops=3)"
"Planning Time: 3.060 ms"
"JIT:"
"  Functions: 159"
"  Options: Inlining true, Optimization true, Expressions true, Deforming true"
"  Timing: Generation 4.034 ms, Inlining 156.229 ms, Optimization 229.043 ms, Emission 171.977 ms, Total 561.283 ms"
"Execution Time: 59343.501 ms"
