"QUERY PLAN"
"Sort  (cost=145243.05..145993.49 rows=300173 width=154) (actual time=1073.076..1118.755 rows=189380 loops=1)"
"  Sort Key: (sum(dp.subtotal)) DESC, (count(dp.id_producto)) DESC"
"  Sort Method: external merge  Disk: 17256kB"
"  ->  GroupAggregate  (cost=48117.08..94333.66 rows=300173 width=154) (actual time=671.813..990.471 rows=189380 loops=1)"
"        Group Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre"
"        ->  Gather Merge  (cost=48117.08..83077.18 rows=300173 width=96) (actual time=671.772..863.128 rows=300173 loops=1)"
"              Workers Planned: 2"
"              Workers Launched: 2"
"              ->  Sort  (cost=47117.06..47429.74 rows=125072 width=96) (actual time=651.838..680.361 rows=100058 loops=3)"
"                    Sort Key: (CASE WHEN (a.id_producto IS NOT NULL) THEN 'Agua'::text WHEN (g.id_producto IS NOT NULL) THEN 'Gaseosa'::text WHEN (c.id_producto IS NOT NULL) THEN 'Cerveza'::text ELSE 'Otro'::text END), p.nombre, p.marca, prov.nombre, ped.id_pedido"
"                    Sort Method: external merge  Disk: 8328kB"
"                    Worker 0:  Sort Method: external merge  Disk: 8128kB"
"                    Worker 1:  Sort Method: external merge  Disk: 8688kB"
"                    ->  Hash Join  (cost=21151.41..30112.72 rows=125072 width=96) (actual time=119.104..309.493 rows=100058 loops=3)"
"                          Hash Cond: (dp.id_pedido = ped.id_pedido)"
"                          ->  Parallel Hash Join  (cost=17446.41..26079.39 rows=125072 width=76) (actual time=84.513..241.380 rows=100058 loops=3)"
"                                Hash Cond: (p.id_producto = dp.id_producto)"
"                                ->  Hash Left Join  (cost=11265.54..18694.05 rows=125000 width=66) (actual time=55.781..172.800 rows=100000 loops=3)"
"                                      Hash Cond: (p.id_producto = c.id_producto)"
"                                      ->  Hash Left Join  (cost=8474.54..15574.92 rows=125000 width=62) (actual time=40.925..133.961 rows=100000 loops=3)"
"                                            Hash Cond: (p.id_producto = g.id_producto)"
"                                            ->  Hash Left Join  (cost=5683.54..12455.80 rows=125000 width=58) (actual time=25.858..92.911 rows=100000 loops=3)"
"                                                  Hash Cond: (p.id_producto = a.id_producto)"
"                                                  ->  Parallel Hash Join  (cost=2990.54..9434.67 rows=125000 width=54) (actual time=10.443..52.049 rows=100000 loops=3)"
"                                                        Hash Cond: (p.id_proveedor = prov.id_proveedor)"
"                                                        ->  Parallel Seq Scan on productos p  (cost=0.00..6116.00 rows=125000 width=38) (actual time=0.016..8.601 rows=100000 loops=3)"
"                                                        ->  Parallel Hash  (cost=2255.24..2255.24 rows=58824 width=24) (actual time=10.275..10.276 rows=33333 loops=3)"
"                                                              Buckets: 131072  Batches: 1  Memory Usage: 6880kB"
"                                                              ->  Parallel Seq Scan on proveedores prov  (cost=0.00..2255.24 rows=58824 width=24) (actual time=0.023..3.173 rows=33333 loops=3)"
"                                                  ->  Hash  (cost=1443.00..1443.00 rows=100000 width=4) (actual time=14.942..14.943 rows=100000 loops=3)"
"                                                        Buckets: 131072  Batches: 1  Memory Usage: 4540kB"
"                                                        ->  Seq Scan on agua a  (cost=0.00..1443.00 rows=100000 width=4) (actual time=0.016..5.379 rows=100000 loops=3)"
"                                            ->  Hash  (cost=1541.00..1541.00 rows=100000 width=4) (actual time=14.636..14.636 rows=100000 loops=3)"
"                                                  Buckets: 131072  Batches: 1  Memory Usage: 4540kB"
"                                                  ->  Seq Scan on gaseosas g  (cost=0.00..1541.00 rows=100000 width=4) (actual time=0.019..5.519 rows=100000 loops=3)"
"                                      ->  Hash  (cost=1541.00..1541.00 rows=100000 width=4) (actual time=14.483..14.483 rows=100000 loops=3)"
"                                            Buckets: 131072  Batches: 1  Memory Usage: 4540kB"
"                                            ->  Seq Scan on cervezas c  (cost=0.00..1541.00 rows=100000 width=4) (actual time=0.020..5.597 rows=100000 loops=3)"
"                                ->  Parallel Hash  (cost=3973.72..3973.72 rows=176572 width=14) (actual time=27.669..27.670 rows=100058 loops=3)"
"                                      Buckets: 524288  Batches: 1  Memory Usage: 18240kB"
"                                      ->  Parallel Seq Scan on detallespedido dp  (cost=0.00..3973.72 rows=176572 width=14) (actual time=0.024..7.636 rows=100058 loops=3)"
"                          ->  Hash  (cost=2455.00..2455.00 rows=100000 width=4) (actual time=34.237..34.237 rows=100000 loops=3)"
"                                Buckets: 131072  Batches: 1  Memory Usage: 4540kB"
"                                ->  Seq Scan on pedidos ped  (cost=0.00..2455.00 rows=100000 width=4) (actual time=13.766..24.333 rows=100000 loops=3)"
"                                      Filter: (fecha >= (CURRENT_DATE - '5 years'::interval))"
"Planning Time: 2.335 ms"
"JIT:"
"  Functions: 162"
"  Options: Inlining false, Optimization false, Expressions true, Deforming true"
"  Timing: Generation 3.019 ms, Inlining 0.000 ms, Optimization 1.904 ms, Emission 39.728 ms, Total 44.651 ms"
"Execution Time: 1140.026 ms"
